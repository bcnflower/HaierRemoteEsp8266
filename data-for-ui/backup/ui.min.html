<!DOCTYPE html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>AC Control</title><style>.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.bi{color:#fff;background-color:#5bc0de;border-color:#46b8da}.bd{color:#333;background-color:#e6e6e6;border-color:#adadad}.b{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.42857143;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-image:none;border:1px solid transparent;border-radius:4px;width:55px;margin:5px;overflow-y:auto}.c{text-align:center}.t{width:80px;font-weight:700;font-size:2.2em;padding-top:12px;padding-bottom:12px}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}input[type=text]#unit{-webkit-appearance:none!important;border-left:0;margin:0 0 0 -40px}input[type=number]#tmp{-webkit-appearance:none!important;border-right:0;outline:0}</style></head><body style='font-family:verdana'><div class='container'><table border='2' class='c'><tr><td colspan='3'>-----------AC Control------------</td></tr><tr><td>AC State:</td><td><a id='pb' class='b bd t' onclick='tp()'>OFF</a></td></tr><tr><td colspan='3'><div class='menu-container'><a id='f0' class='b bd' onclick='fs(0)'>Auto</a> <a id='f1' class='b bd' onclick='fs(1)'>Low</a> <a id='f2' class='b bd' onclick='fs(2)'>Medium</a> <a id='f3' class='b bd' onclick='fs(3)'>High</a></div></td></tr><tr><td colspan='3'><div class='menu-container'><a id='m0' class='b bd' onclick='m(0)'>Auto</a> <a id='m1' class='b bd' onclick='m(1)'>Cool</a> <a id='m2' class='b bd' onclick='m(2)'>Dry</a> <a id='m3' class='b bd' onclick='m(3)'>Heat</a> <a id='m4' class='b bd' onclick='m(4)'>Fan</a></div></td></tr><tr><td colspan='3'><div class='menu-container'><a id='s0' class='b bd' onclick='sw(0)'>Off</a> <a id='s1' class='b bd' onclick='sw(1)'>Up</a> <a id='s2' class='b bd' onclick='sw(2)'>Down</a> <a id='s3' class='b bd' onclick='sw(3)'>Change</a></div></td></tr><tr><td colspan='3'><div class='menu-container'><a id='s0' class='b bd t' onclick='tmpChg(-1)'>-</a> <input class='b bd t' type='number' id='tmp' style='width:80px' value='26' onchange='tmpChg(0)'> <input class='b bd t' id='unit' value='&deg;C' disabled> <a id='s2' class='b bd t' onclick='tmpChg(1)'>+</a></div></td></tr></table></div><script>var s={},tmp=id("tmp");function id(t){return document.getElementById(t)}function txt(t,s){t.innerHTML=s}function btTgl(t,s=!0){s?(t.classList.remove("bd"),t.classList.add("bi")):(t.classList.remove("bi"),t.classList.add("bd"))}function tpc(t){var s=id("pb");txt(s,t?"ON":"OFF"),btTgl(s,t)}function tp(){p=s.power,s.power=!p,tpc(!p),post()}function fsc(t){for(var s=0;s<4;++s)btTgl(id("f"+s),0);btTgl(id("f"+t),1)}function fs(t){0!==s.mode&&(fsc(s.fan=t),post())}function mc(t){for(var s=0;s<5;++s)btTgl(id("m"+s),0);btTgl(id("m"+t),1)}function m(t){mc(s.mode=t),post()}function swc(t){for(var s=0;s<4;++s)btTgl(id("s"+s),0);btTgl(id("s"+t),1)}function sw(t){swc(s.swing=t),post()}function tmpChg(t){0==t?(console.log(tmp.value),s.temp=parseInt(tmp.value)):s.temp+=t,s.temp<16&&(s.temp=16),30<s.temp&&(s.temp=30),tmp.value=s.temp,post()}function doPost(){var t=new XMLHttpRequest;t.timeout=2e3,t.open("PUT","state",!0),t.setRequestHeader("Content-Type","application/json"),console.log(JSON.stringify(s)),t.send(JSON.stringify(s))}var posting=!(s.temp=26),multiplePost=!1;function post(){posting?multiplePost=!0:(posting=!0,doPost(),setTimeout(()=>{multiplePost&&(doPost(),multiplePost=!1),posting=!1},5e3))}function loadJSON(t,s,e){var o=new XMLHttpRequest;o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&(200===o.status?s&&s(JSON.parse(o.responseText)):e&&e(o))},o.open("GET",t,!0),o.send()}function updtState(){loadJSON("state",function(t){console.log(t),tpc((s=t).power),fsc(s.fan),mc(s.mode),swc(s.swing),btTgl(id("pb"),s.power),tmp.value=s.temp},function(t){console.error(t)})}updtState()</script></body></html>