<!DOCTYPE html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>AC Control</title><style>.container{margin-right:auto;margin-left:auto}.bi{color:#fff;background-color:#5bc0de;border-color:#46b8da}.bi:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.bd{color:#333;background-color:#f6f6f6;border-color:#adadad}.bd:hover{color:#333;background-color:#f6f6f6;border-color:#adadad}.bh{color:#fff;background-color:#d9534f;border-color:#d43f3a}.bh:hover{color:#fff;background-color:#ff5a55;border-color:#2d1918}.b{display:inline-block;padding:8px 8px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.42857143;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-image:none;border:2px solid #000;border-radius:4px;width:60px;margin:5px;overflow-y:auto}.c{text-align:center}.t{width:70px;font-weight:700;font-size:2em}.h{background-color:#337ab7;color:#fff;border-radius:4px;padding:5px 15px;text-align:center;text-decoration:none;margin-top:5px;margin-bottom:8px;box-shadow:0 4px 2px 0 rgb(0 0 0 / 20%),0 6px 20px 0 rgb(0 0 0 / 19%);text-shadow:3px 4px 7px rgba(81,67,21,.8)}.box{color:#055160;background-color:#cff4fc;border-color:#b6effb;border-radius:4px;padding:5px;margin-right:6px;margin-left:6px;margin-bottom:6px}.myForm{background:#fff;padding:2em 1.5em 1em;border:1px solid #55c5c5;border-radius:4px;box-shadow:0 4px 8px 0 rgb(0 0 0 / 20%),0 6px 20px 0 rgb(0 0 0 / 19%);margin:0 auto;max-width:600px;min-width:350px}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}</style></head><body style='font-family:verdana'><div class='container'><div class='myForm c'><h1 class='h'>Haier AC Control Panel</h1><div class='box'><h3 class='h'>Power</h3><a id='pb' class='b bd t' onclick='tp()'>OFF</a></div><div class='box'><h3 class='h'>Temperature &deg;C</h3><div class='menu-container'><a class='b bi t' onclick='tmpChg(-1)'>-</a> <input class='b bd t' type='number' id='tmp' style='width:80px' value='26' onchange='tmpChg(0)'> <a class='b bh t' onclick='tmpChg(1)'>+</a></div></div><div class='box'><h3 class='h'>Fan Speed</h3><div class='menu-container'><a id='f0' class='b bd' onclick='fs(0)'>Auto</a> <a id='f1' class='b bd' onclick='fs(1)'>Low</a> <a id='f2' class='b bd' onclick='fs(2)'>Medium</a> <a id='f3' class='b bd' onclick='fs(3)'>High</a></div></div><div class='box'><h3 class='h'>Climate Mode</h3><div class='menu-container'><a id='m0' class='b bd' onclick='m(0)'>Auto</a> <a id='m1' class='b bd' onclick='m(1)'>Cool</a> <a id='m2' class='b bd' onclick='m(2)'>Dry</a> <a id='m3' class='b bd' onclick='m(3)'>Heat</a> <a id='m4' class='b bd' onclick='m(4)'>Fan</a></div></div><div class='box'><h3 class='h'>Veritcal Swing Mode</h3><div class='menu-container'><a id='s0' class='b bd' onclick='sw(0)'>Stop</a> <a id='s1' class='b bd' onclick='sw(1)'>Auto</a> <a id='s2' class='b bd' onclick='sw(2)'>Top</a> <a id='s3' class='b bd' onclick='sw(3)'>Front</a> <a id='s4' class='b bd' onclick='sw(4)'>Bottom</a> <a id='s5' class='b bd' onclick='sw(5)'>Down</a></div></div><div class='box'><h3 class='h'>Other Controls</h3><div class='menu-container'><a id='tr' class='b bd' onclick='tr()'>Turbo</a> <a id='hl' class='b bd' onclick='hl()'>Health</a> <a id='dt' class='b bd' onclick='dt()'>Display</a> <a id='qt' class='b bd' onclick='qt()'>Quiet</a></div></div><div class='box'><h3 class='h'>Conntrol Settings</h3><a id='sv' class='b bd' onclick='sv()'>Save</a> <a id='as' class='b bd' style='width:80px' onclick='as()'>Auto Send</a> <a id='sn' class='b bd' onclick='sn()'>Send ></a></div></div></div><script>var s={},vas=!0,to=300,tmp=id("tmp");function id(t){return document.getElementById(t)}function txt(t,s){t.innerHTML=s}function btTgl(t,s=!0,o="bi",n="bd"){s?t.classList.replace(n,o):t.classList.replace(o,n)}function tpc(t){var s=id("pb");txt(s,t?"ON":"OFF"),btTgl(s,t)}function tp(){p=s.power,s.power=!p,tpc(!p),post()}function fsc(t){for(var s=0;s<4;++s)btTgl(id("f"+s),0);btTgl(id("f"+t),1)}function fs(t){0!==s.mode&&(fsc(s.fan=t),post())}function mc(s){for(var o=0;o<5;++o)btTgl(id("m"+o),0);btTgl(id("m"+s),1),t=3==s?"bh":1==s?"bi":"bd",tmp.classList.value="b t "+t}function m(t){mc(s.mode=t),post()}function swc(t){for(var s=0;s<6;++s)btTgl(id("s"+s),0);btTgl(id("s"+t),1)}function sw(t){swc(s.swingV=t),post()}function tmpChg(t){0==t?(console.log(tmp.value),s.temp=parseInt(tmp.value)):s.temp+=t,s.temp<16&&(s.temp=16),30<s.temp&&(s.temp=30),tmp.value=s.temp,post()}function trc(t){btTgl(id("tr"),t)}function tr(){t=s.turbo,s.turbo=!t,trc(!t),qtc(s.quiet=0),post()}function qtc(t){btTgl(id("qt"),t)}function qt(){q=s.quiet,s.quiet=!q,qtc(!q),trc(s.turbo=0),post()}function hlc(t){btTgl(id("hl"),t)}function hl(){h=s.health,s.health=!h,hlc(!h),post()}function asc(t){btTgl(id("as"),t)}function as(){asc(vas=!vas)}function dt(){var t=id("dt");btTgl(t,1),s.disp=1,doPost(),s.disp=0,setTimeout(()=>{btTgl(t,0)},to)}function sn(){var t=id("sn");btTgl(t,1),doPost(),setTimeout(()=>{btTgl(t,0)},to)}function sv(){var t=id("sv");btTgl(t,1),doPost("?save=1"),setTimeout(()=>{btTgl(t,0)},to)}function doPost(t=""){var o=new XMLHttpRequest;o.timeout=2e3,o.open("PUT","state"+t,!0),o.setRequestHeader("Content-Type","application/json"),console.log(JSON.stringify(s)),o.send(JSON.stringify(s))}var posting=!(s.temp=26),multiplePost=!1;function post(){vas&&(posting?multiplePost=!0:(posting=!0,doPost(),setTimeout(()=>{multiplePost&&(doPost(),multiplePost=!1),posting=!1},5e3)))}function loadJSON(t,s,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?s&&s(JSON.parse(n.responseText)):o&&o(n))},n.open("GET",t,!0),n.send()}function updtState(){asc(vas),loadJSON("state",function(t){console.log(t),tpc((s=t).power),fsc(s.fan),mc(s.mode),swc(s.swingV),trc(s.turbo),qtc(s.quiet),hlc(s.health),btTgl(id("pb"),s.power),tmp.value=s.temp},function(t){console.error(t)})}updtState()</script></body></html>